sudo: required
language: python
before_install:
- export TAG=`if [ "$TRAVIS_BRANCH" == "master" ]; then echo "latest"; else echo $TRAVIS_BRANCH ; fi`
- curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
- sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
- sudo apt-get update
- sudo apt-get -y install docker-ce
- docker build -t $REPO:$TAG .
- docker run --name tinyproxy -d $REPO:$TAG 
- docker ps -a
script:
- docker exec -tinyproxy pgrep tinyproxy
after_script:
- docker rm -f tinyproxy
after_success:
- docker login -e $DOCKER_HUB_EMAIL -u $DOCKER_HUB_USER -p $DOCKER_HUB_PASSWORD"
- docker tag $REPO:$TAG $REPO:$TRAVIS_BUILD_NUMBER
- docker push $REPO
env:
  global:
  - secure: t4n8tpdM4tk9HXDacTVNJliNZh8idTv1CJKvXZE978TynAhzuN5iIFt/ipckBBfRdxrmD1XBRclC/hzmSBnTn6l2L4XBrXHqbC0SZkSkldKu0dFR7H/6FXWsgdnrZvWvJOXhsbRDuIlrMbWa4+sFxOnijq4gUaB3qICh+7Y6j3VW0MH1HHxEfowuutd0SRf6aM8aVLN8qutWKMxigrsN0RIGBJaNB7klnk4acRAU/LQO20XRgp7OSFqt666joY7CODxdSk1mX/S1OiEa4s9XvWnZgmQmAiI4C1tF3+GF+3rLtYsaq0vTF5gMaVzpnzYUCGuViGTI+nTL45wGiehRNxXOCT07wMNMjawqWE3Ut1o3q0TSj/Ob+MoCR3ZRKK6GiofPZdqBfEeyf63fBA133d4N8LmIKeix4jdBeN1/Q5L/1R9AHetjd4Bo7ZXigkh602jQ8JSGATO9kZ3vDyaPoiTUna7LPEIxThqgx1zTve8zCZAXApVFIZgNmN8QwC/X50imMZRTjSOoF4cG268YExSl7aXoRg4dG9BZqEdnTQbmJv65yBGWAGeYb5XnYaP17gaWpiHZFmlINI0coP7gPDZeuBHg0BHB77lsJ7iNhTk4NbvStNc60ExqpGvYFQnSHZ+iw1ab3zp2c8NbsyPL4YFZPlqgUNVy7UO9shkFrws=
  - secure: qm4tbBkMzZv8wnps1nP8gDJ9LTidLEsh03I1Ecr/LSqSjd00FwaB7OWC5589VbKoYt2zxjRckPbdle2NF5zUbbwSsS3XW9hB4qyb1K8sVqN8BnZf/gWxuVmiG90iV3VHWpB3DFPFilcabmduoh0Cmw68uX4R+NHVxF9nK5/xRLatKBXVVnFDbsT25h/xgqpFMEpMKpgivq0xjZrElz00am/kaIzQgzur4BOZgdxrqylwZaWUomviXX3LCHkya3IAT+FsUm+9R7b6VKU1EVuFi1nhNy5po8sjXazesYGZH8qUP9l6aRAy5xESWX/fU4UwWtsLt8+EVW4DFFhji99NiTHpJZrb0T34zysTEKk1jx+tMUEUby4wgRlIegH1b0qA926cs4XT6dkFqivqvTCT27KXUJ1cPFxL7gkZGbTqf9AYRleLssQE0prlsaw4TJ6FpxBfSEI1SjfharmHyUxs/u1MCLPPmfw27GdzxBZIZAdDZUL/yrzPFGxUT4HC5ApqlSH2jRg6/9K+IrpUKab7CROFKOh9rU9JI8/OxTc9Ixew5VvywyD6lKiYhiiYnwGuLSTPI/A6XTmmqxLPxn6u3R2B4e819hzAMxsjk/ihN8z2NUhz82FNxkIdiZRo5cFWl4U+v0ce/sAE2Fy83e35lwTJkhQHFR60v1oIt9KNqEs=
  - secure: SArcmLv+/rRFL7zLDNsywEyoMnnNzCSWb2O9+ppa54zfK7TbfxXA43mrEF2gzPUpFRlEz7+0iP3WpWIdLez/IBIShphO1cR7kr4LeY4CKvF1YintMSkQNOHcLUsDKu0Tu+/aPY1+Z22BSh9BKbYaZ76dSw85uZcOKGyNoO+k+DfJb+UDbigoJFy5Y2ob9bZqfoUkN8x6alXGdz+hY4F9dEse++DLxEgC04+YR1uvbpS73dlAtgI9GlMAhUZkW7vNLVqwanoLa6Y74DdcFUOM+gjWIXJ4xSwnXcU1llShHBQzjsA4YUSBCUpNJlUQKL/WEXAFkcfyjstZ11P6T8cmiOvT4v+Lcm9dWPX6tyNHtU0MTBOT0A4B3cixSR9zjScOJc8k6W2IHQgt+DBjbkLBF0GMmZHhOYV+YCs20R3lQICnBeYzntIjqSSyponaKElnzgYojzsECrhQmE6oWS/oR+NtuTdQGH59yGihF8NohoiKaLrR5kYTWXioRQcozOAHwv4RnZ3SIMRHSjKyab9R8knnHXIEtYHs13bW565D6sFr8Ie0idOboN2T94Hj2U2dZGT+n55VwNVW9dVQOW26K432QqFu+orRIwHDfVggW4u9h0Fh/2sJnIoVpl4ShYF8SCfY0i0GkpDU+HV7zeiW5KFtc5qMUxeNmcWyGf3RKFw=
  - REPO=$DOCKER_HUB_USERNAME/tinyproxy
notifications:
  pushover:
    api_key:
      secure: CBScinrcwSS7nHzDz4m868WfCZLMwi5H5nc4+4tNSJ/mTL1VQ5O2V40uJ0xhoOhy2AmEs2bEnSP9GmcM0utX6JFqAizhYcQaVMk7t8Z/rXF17RkLCOWdZrVjMsPmvqdm/pxEN/rXnrWrvv0vnbyt0ywDe4AnI/IY8IaNzL15sH1ETLi0hpfarfCfBVpVlSGl01chPvBgwc4RsXfC/Bne8IQ5NomasTUDbxn8CO10rHa69G5S5T+Ky39lTvLpBB1NlcQ3RFom4OB60puERN8OZl3w9EVFCmy82b3ROiiHsZg9ymLCAbzCaygsv99LxjcWWlnL32DVXF0JD7b3t8D2Ny8Shi0T8HPnXzRUGJI9wTRvYx/qiJ/H8LArZC+QxHjxn1pjpGAw7MVtdr7MGrfL5atiQkhM7ST2AwF56q5cjl8EII8GTCc9gDfIOLRDheH3AJjom+Rh6fjsFu4QepX9hdhI+tvd1TVUM7mbBIMG8Kaxa6kpQzj2rTJD9cR9DJc8C98GDfE5VBRorFqj2Fy9Kd2XxlWAvpSOgRXRztyn6/t0cvfiN7gC6iHj1yXdbccDZO9ihYXrtOZKtX/Y6SwO2WkjsdD1Sxh7g2msT42Z2P6FuRFdeMYDua8trgN56F8hkh6klxrXbXx10Wf9jCjZi1ywKdBYPE0iiCPHt/tPFHM=
    users:
      secure: pJHRACbMPLa7sJkqpL1kNXlPwrCaPTNICSo/x5vFli3b2urLSPn7esaI0psuPFg3k492XRKBZ9/vYYUZGMKPCdw3OiIgegNz0mnsD2Dcn6aG5/8PoSq/LyXcdBEF1MSK7EcD3XYPKP9vCbCz/WjaDbxPYcLu4WjSJyuaAF0RA9igXMaMZkEBaxZY0e2xxz3cWWkXkF3rqw/+g+CcdWy/aEpCvOcS2vNdCzITMTkkWejeIjA5dGZuSdyEq8wVoCmfCli50z6ihpVbSG5UKBt7c8tmaGtb9erI076V3EkdF22ccEw4jjvOcFps3NCrSbMGVD8+bNLvA05qszeQOdd5sTuXnXFlY6NzXThfgA6jXUi8bfcp8HUsv0BJ+AAlz2u2+8Oj+297ZAzxGT2ECZegtgvZFWgpq5+5na8sQT7+XtS2oPXa6DvGkB9mCb1dX0jWr+JCIewZEUgzpYLcB4hvpDMdvefsPBKP6/a4K5iOo64WfuQ5nkBwLrNS97ymYmbvG1n4TdLmvFz7VboxKaPIR2okXbJnNacZCrXfH1XZyzUtBKf/qzHKdty8+TcDr9NQZ6qZ539/S8ODbDrQLFUPmX2XHvTAGhHRDdtZ+o8cdeKbTy3JKh+8TXFWrJPqZRL+DcVYmSxAIBoxb2G2lrfNKsJKG6eihxeJUtpqkT305vk=
